window.DL=window.DL||{};(function(_,Modernizr,DL){"use strict";var metaBoxes=document.getElementsByClassName("dlui-metabox-tabs");if(!metaBoxes.length){return false}_.forEach(metaBoxes,function(metaBox){var tabsCollection=[],fieldsets=metaBox.getElementsByClassName("dl-metabox-fieldset"),fParent=fieldsets[0].parentElement,tabsNavTitles=[],tabsNav=document.createElement("ul");if(!fieldsets.length){return false}for(var tabCounter=0;tabCounter<fieldsets.length;++tabCounter){var fieldset=fieldsets[tabCounter],fattributes=fieldset.attributes,description=fieldset.querySelector(':scope > [class*="__description"]'),fields=fieldset.getElementsByClassName("dl-field"),currNavTitle={};currNavTitle.label=document.createTextNode(fieldset.firstElementChild.innerText);var iconClass=fieldset.firstElementChild.getAttribute("data-icon");if(iconClass){var el=document.createElement("i");el.className=iconClass;currNavTitle.icon=el}tabsNavTitles.push(currNavTitle);fattributes.removeNamedItem("form");fattributes.removeNamedItem("name");var tabWrapper=document.createElement("div"),tabDescription=document.createElement("p");if(description){tabDescription.appendChild(document.createTextNode(description.innerText));tabDescription.className="dl-metabox-tabs__tab-description";tabWrapper.appendChild(tabDescription)}for(var fc=0;fc<fields.length;fc++){var cfield=fields[fc].cloneNode(true),tr=document.createElement("div"),tdLabel=document.createElement("div"),tdType=document.createElement("div"),cfieldLabel=cfield.getElementsByTagName("label")[0],classScope=cfield.classList.item(0),cfieldDescription=cfield.querySelector(".dl-field__description");if(cfieldLabel){tdLabel.appendChild(cfieldLabel);tdLabel.classList.add(classScope+"__label")}if(cfieldDescription){tdLabel.appendChild(cfieldDescription)}_.forEach(cfield.childNodes,function(node){node=node.cloneNode(node);tdType.appendChild(node)});tdType.classList.add(cfield.classList.item(0)+"__type");tr.appendChild(tdLabel);tr.appendChild(tdType);_.forEach(cfield.classList,function(item){tr.classList.add(item)});tabWrapper.appendChild(tr)}_.forEach(fieldset.parentNode.querySelectorAll(':scope > [type="hidden"]'),function(hidden){tabWrapper.appendChild(hidden)});tabWrapper.setAttribute("id",fieldset.firstElementChild.innerText.toLowerCase().replace(/[^a-z0-9]/g,"_"));tabWrapper.setAttribute("class","dl-metabox-tabs__tab");tabsCollection.push(tabWrapper)}tabsNav.setAttribute("class","dl-metabox-tabsnav");var li,a;for(var c=0;c<tabsCollection.length;++c){li=document.createElement("li");a=document.createElement("a");li.setAttribute("class","dl-metabox-tabsnav__item");a.setAttribute("class","dl-metabox-tabsnav__link");a.setAttribute("href","#"+tabsCollection[c].getAttribute("id"));if("icon"in tabsNavTitles[c]){a.appendChild(tabsNavTitles[c].icon)}a.appendChild(tabsNavTitles[c].label);li.appendChild(a);tabsNav.appendChild(li)}var tabs=document.createElement("div");tabs.setAttribute("class","dl-metabox-tabs");tabs.appendChild(tabsNav);_.forEach(tabsCollection,function(tab){tabs.appendChild(tab)});fParent.innerHTML="";fParent.appendChild(tabs);fParent.querySelectorAll(".dl-metabox-tabsnav__link")[0].classList.add("dlu-active");tabs=tabs.getElementsByClassName("dl-metabox-tabs__tab");tabs[0].classList.add("dltab-opened");[].slice.call(tabs,1).forEach(function(tab){tab.classList.add("dltab-closed")});var tabsNavLinks=Array.prototype.slice.call(metaBox.getElementsByClassName("dl-metabox-tabsnav")[0].getElementsByClassName("dl-metabox-tabsnav__link"));_.forEach(tabsNavLinks,function(el){el.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();_.forEach(tabsNavLinks,function(item){item.classList.remove("dlu-active")});this.classList.add("dlu-active");var tab=document.querySelector(this.getAttribute("href"));_.forEach(tabs,function(item){if(item.getAttribute("id")===tab.getAttribute("id")){item.classList.remove("dltab-closed");item.classList.add("dltab-opened");return}item.classList.remove("dltab-opened");item.classList.add("dltab-closed")});DL.Utils.Events.dispatchEvent("dl-tab-opened",document)})})})})(_,window.Modernizr,window.DL);