window.DL=window.DL||{};(function(_,DL){"use strict";DL.Geo=DL.Geo||{};DL.Geo.UserPosition={options:{enableHighAccuracy:true,timeout:5e3,maximumAge:0},lat:function(){return this.latitude?this.latitude:0},lng:function(){return this.longitude?this.longitude:0},currentPosition:function(successCB,errorCB){if(!this.allowed()){throw"Qibla cannot geolocated user. User agent doesn't support navigator.geolocation"}navigator.geolocation.getCurrentPosition(function(position){this.latitude=position.coords.latitude;this.longitude=position.coords.longitude;if(_.isFunction(successCB)){successCB.call(this)}}.bind(this),function(error){console.warn("Qibla User Geolocation failed. Code:"+error.code+"Message: "+error.message);if(_.isFunction(errorCB)){errorCB.call(this)}}.bind(this),this.options);return this},allowed:function(){if(false==="geolocation"in navigator){console.warn("Geolocation not found.");return false}return true},construct:function(){if(!this.allowed()){return}_.bindAll(this,"lng","lat","allowed","currentPosition");this.latitude=0;this.longitude=0;return this}};DL.Geo.UserPositionFactory=function(){return Object.create(DL.Geo.UserPosition).construct()}})(_,window.DL);